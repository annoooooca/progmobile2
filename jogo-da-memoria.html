<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Mem√≥ria</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f0f4f8;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        min-height: 100vh;
        margin: 0;
    }
    h1 {
        color: #1E3A8A;
    }
    #tabuleiro {
        display: grid;
        grid-template-columns: repeat(4, 100px);
        gap: 10px;
        margin-top: 20px;
    }
    .carta {
        width: 100px;
        height: 100px;
        background: #007bff;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-size: 2rem;
        cursor: pointer;
        border-radius: 10px;
        user-select: none;
        transition: transform 0.3s;
    }
    .carta.virada {
        background: #fff;
        color: #007bff;
        transform: rotateY(180deg);
    }
    #ranking {
        display:none; 
        position: fixed; 
        top:0; 
        left:0; 
        width:100%; 
        height:100%; 
        background: rgba(0,0,0,0.7); 
        color:#fff; 
        justify-content:center; 
        align-items:center; 
        flex-direction:column; 
        padding:20px; 
        overflow:auto;
    }
    #ranking button {
        margin-top:20px; 
        padding:10px 20px; 
        border:none; 
        border-radius:8px; 
        background-color:#007bff; 
        color:white; 
        font-weight:bold; 
        cursor:pointer;
    }
</style>
</head>
<body>

<h1>Jogo da Mem√≥ria</h1>
<div id="tabuleiro"></div>

<div id="ranking">
    <h2>Ranking Global</h2>
    <ol id="lista-ranking"></ol>
    <button onclick="document.getElementById('ranking').style.display='none'">Fechar</button>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

// Configura√ß√£o Firebase (substitua pelos seus dados)
const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_PROJETO.firebaseapp.com",
    projectId: "SEU_PROJETO",
    storageBucket: "SEU_PROJETO.appspot.com",
    messagingSenderId: "SEU_ID",
    appId: "SEU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// --- Fun√ß√µes Firebase ---
async function salvarRankingFirebase(nome, pontuacao, tempo) {
    try {
        await addDoc(collection(db, "rankingMemoria"), {
            nome: nome,
            pontuacao: pontuacao,
            tempo: tempo,
            data: new Date()
        });
        console.log("Ranking salvo!");
    } catch (e) {
        console.error("Erro ao salvar ranking: ", e);
    }
}

async function mostrarRankingFirebase() {
    const lista = document.getElementById('lista-ranking');
    lista.innerHTML = '';

    const q = query(collection(db, "rankingMemoria"), orderBy("pontuacao", "desc"), limit(10));
    const querySnapshot = await getDocs(q);

    querySnapshot.forEach((doc) => {
        const item = doc.data();
        const li = document.createElement('li');
        li.textContent = `Nome: ${item.nome}, Pares: ${item.pontuacao}, Tempo: ${item.tempo}`;
        lista.appendChild(li);
    });

    document.getElementById('ranking').style.display = 'flex';
}

// --- Jogo da Mem√≥ria ---
const tabuleiro = document.getElementById('tabuleiro');
let cartas = [];
let primeiraCarta = null;
let segundaCarta = null;
let paresEncontrados = 0;
let timerInicio = null;

// Criar cartas (8 pares)
const simbolos = ['üçé','üçå','üçá','üçì','ü•ù','üçç','üçí','üçâ'];
cartas = [...simbolos, ...simbolos];
cartas = cartas.sort(() => Math.random() - 0.5);

cartas.forEach((simbolo) => {
    const div = document.createElement('div');
    div.classList.add('carta');
    div.textContent = "";
    div.dataset.simbolo = simbolo;
    div.addEventListener('click', virarCarta);
    tabuleiro.appendChild(div);
});

function virarCarta() {
    if(!timerInicio) timerInicio = Date.now();
    if(this.classList.contains('virada') || segundaCarta) return;

    this.classList.add('virada');
    this.textContent = this.dataset.simbolo;

    if(!primeiraCarta) {
        primeiraCarta = this;
    } else {
        segundaCarta = this;
        if(primeiraCarta.dataset.simbolo === segundaCarta.dataset.simbolo){
            paresEncontrados++;
            primeiraCarta = null;
            segundaCarta = null;
            if(paresEncontrados === simbolos.length){
                setTimeout(anunciarFimDeJogo, 500);
            }
        } else {
            setTimeout(() => {
                primeiraCarta.classList.remove('virada');
                segundaCarta.classList.remove('virada');
                primeiraCarta.textContent = "";
                segundaCarta.textContent = "";
                primeiraCarta = null;
                segundaCarta = null;
            }, 800);
        }
    }
}

function anunciarFimDeJogo() {
    const tempoFinal = Math.floor((Date.now() - timerInicio) / 1000);
    const minutos = Math.floor(tempoFinal / 60).toString().padStart(2,'0');
    const segundos = (tempoFinal % 60).toString().padStart(2,'0');
    const tempoFormatado = `${minutos}:${segundos}`;

    const nomeJogador = prompt(`Parab√©ns! Voc√™ encontrou todos os pares.\nDigite seu nome para o ranking:`);
    if(nomeJogador){
        salvarRankingFirebase(nomeJogador, paresEncontrados, tempoFormatado).then(() => {
            mostrarRankingFirebase();
        });
    }
}
</script>

</body>
</html>
